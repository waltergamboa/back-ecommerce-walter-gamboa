class ContenedorMariaDB{
    constructor(nombreTabla, opcionesConectar){
        this.nombreTabla = nombreTabla;
        this.opcionesConectar = opcionesConectar;
        this.knex = require("knex")(this.opcionesConectar);
    }

    async getAll(){
        try {
            this.knex = require("knex")(this.opcionesConectar);
            let rows = await this.knex(this.nombreTabla).select("*");
            return rows;
        } catch (error) {
            console.log("Error al buscar los datos", error);
            return [];
        } finally{this.knex.destroy()}
    }

    async getById(id){
        try {
            this.knex = require("knex")(this.opcionesConectar);
            let row = await this.knex(this.nombreTabla).select("*").where("id", id);
            return row;
        } catch (error) {
            console.log("Error al buscar los datos", error);
            return [];
        } finally{this.knex.destroy()}
    }

    async save(obj){
        try {
            this.knex = require("knex")(this.opcionesConectar);
            await this.knex(this.nombreTabla).insert(obj);
        } catch (error) {
            console.log("Error al insertar los datos", error);
        } finally{this.knex.destroy()}
    }

    async updateById(id, obj){
        try {
            this.knex = require("knex")(this.opcionesConectar);
            let row = await this.knex(this.nombreTabla).select("*").where("id", id).update(obj);
            return row;
        } catch (error) {
            console.log("Error al buscar los datos", error);
            return [];
        } finally{this.knex.destroy()}
    }

    async deleteById(id){
        try {
            this.knex = require("knex")(this.opcionesConectar);
            await this.knex(this.nombreTabla).where("id", id).del();
            return 1;
        } catch (error) {
            console.log("Error al borrar los datos", error);
        } finally{this.knex.destroy()}
    }

}

module.exports = ContenedorMariaDB;